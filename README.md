# RM-PRT: Realistic Robotic Manipulation Simulator and Benchmark with Progressive Reasoning Tasks
[[arXiv]](https://arxiv.org/abs/2306.11335) [[Website]](https://necolizer.github.io/RM-PRT/).

## To Do
- [ ] Integrate the physical simulation tool Mujoco into UE5.
- [ ] Support more skills: pulling, pushing, pressing buttons, placing, opening/closing doors, etc.
- [ ] Support more scenarios: retirement homes, coffee shops, etc. Currently, these scenes are already [online](https://necolizer.github.io/RM-PRT/), and corresponding interactive functions will be added.

## Updates
<details>
<summary> 8/13/2023: Release RM-PRT v1.0.0. </summary>
   
ðŸš€ðŸš€ We have released the first version [1.0.0](https://github.com/Necolizer/RM-PRT/releases/tag/v1.0.0) of the RM-PRT benchmark simulator.   
   
   - Built on UE5.
   - Supports [instruction tasks](https://github.com/Necolizer/RM-PRT/blob/main/Env/README.md#tasks) with 4 different difficulty levels.
   - Skill Library: Grab.
   - Scene: Restaurant.
     
</details>

## Introduction
**RM-PRT** is a Robotic Manipulation with Progressive Reasoning Tasks benchmark based on a realistic robotic manipulation simulator. Specifically, the RM-PRT benchmark builds a new high-fidelity digital twin scene based on Unreal Engine 5, which includes 15K natural language instructions generated by ChatGPT for a detailed evaluation of robot manipulation.

![Simulator](./imgs/Simulator.jpg)

## Pipeline
![pipeline](./imgs/pipeline.png)


## Environment
### Resource Consumption
In our experiments, we used 1 NVIDIA GeForce RTX 3090 GPU. And the simulator occupies approximately 2 to 3GB of GPU memory.
### Simulator
See [simulator details](https://github.com/Necolizer/RM-PRT/blob/main/Env/README.md).

## Getting Started

```bash
git clone -b main https://github.com/Necolizer/RM-PRT.git
```

First download the [simulator](https://drive.google.com/drive/folders/1jLXAU9eHE6rcpLtohepGlb654mUbA4KR?usp=sharing) and open it on your computer. Then download a [model checkpoint](https://drive.google.com/file/d/1shH1DV6_rrq7hS6Zn0LrfT7LXbDQt3Us/view?usp=drive_link).

Run the inference code.
```bash
python inference.py --host=localhost:30001 --action_nums=8
```

## Instructions
We have released the instructions for the training set, see the [file](https://github.com/Necolizer/RM-PRT/tree/main/instructions) for more information.

## Available Baselines
- [BC-Z](https://github.com/Necolizer/RM-PRT/tree/main/bcz): Zero-Shot Task Generalization with Robotic Imitation Learning
- [Gato](https://github.com/Necolizer/RM-PRT/tree/main/gato): A Generalist Agent
- [RT-1](https://github.com/Necolizer/RM-PRT/tree/main/robotic_transformer_pytorch): Robotics Transformer for real-world control at scale
- [RT-LP](https://github.com/Necolizer/RM-PRT/tree/main/RT-LP): Robotics Transformer with Language Parsing

you can easily load the model, this is an example
```
from bcz.Extractor import CustomExtractor

action_nums=8
bins=256
net_arch=[]
policy_kwargs = dict(features_extractor_class=CustomExtractor,features_extractor_kwargs ={'action_nums':action_nums,'bins':bins}, net_arch=net_arch)

num_envs = 1
model = PPO("MultiInputPolicy", env, policy_kwargs=policy_kwargs, verbose=1,
    n_steps=rollout_steps // num_envs, batch_size=batch_size,
    n_epochs=10,
    tensorboard_log=save_path,
    gamma=gamma,
    target_kl=target_kl,
    learning_rate=learning_rate
)
```
## Citation
```
@article{rmprt2023,
      title={RM-PRT: Realistic Robotic Manipulation Simulator and Benchmark with Progressive Reasoning Tasks}, 
      author={Pengzhen Ren and Kaidong Zhang and Hetao Zheng and Zixuan Li and Yuhang Wen and Fengda Zhu and Mas Ma and Xiaodan Liang},
      year={2023},
      journal={arXiv:2306.11335}
}
```

## License

This repository is released under the Apache 2.0 license as found in the [LICENSE](LICENSE.md) file.
